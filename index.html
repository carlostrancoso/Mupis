<!DOCTYPE html>
<html lang="">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inscription Mupis</title>
  <link type="text/css" rel="stylesheet" href="./main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/21.0.0/tween.umd.js"></script>


  <script  type="importmap">{
    "imports": {
      "three": "https://threejs.org/build/three.module.js"
    }
  }</script><!-- Remove this when import maps will be widely supported -->
  <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>
  <script type="module">
    
   //bibliotecas
   import * as THREE from 'three';
   import {OrbitControls} from 'https://threejs.org/examples/jsm/controls/OrbitControls.js';
   import {OBJLoader} from 'https://threejs.org/examples/jsm/loaders/OBJLoader.js';
   import {MTLLoader} from 'https://threejs.org/examples/jsm/loaders/MTLLoader.js';
   import { GLTFLoader } from 'https://threejs.org/examples/jsm/loaders/GLTFLoader.js';

  //loading screen

  const manager = new THREE.LoadingManager();
  const loadingContainer = document.querySelector('.loading-screen')
  
  manager.onLoad = function ( ) {

  loadingContainer.style.display='none';
  

};

manager.onError = function ( url ) {

	console.log( 'There was an error loading ' + url );

};

  //janela e motor render
  var canvas = document.querySelector('#c');
  var renderer = new THREE.WebGLRenderer({canvas, alpha:true});
  renderer.setClearColor( 0xEDEDED, 0 );
    
  //camera
  var fov = 25;
  var aspect = 2;  // the canvas default
  var near = 1;
  var far = 50;
  var camera = new THREE.PerspectiveCamera(fov, aspect, near, far);
  camera.position.set(0, 15, 25);
    
  //controlo orbita
  var controls = new OrbitControls(camera, canvas);
  controls.enableDamping = true;
  controls.dampingFactor = 0.05;  
  controls.target.set(0, 1, 0);
  controls.enableZoom = true;
  controls.enablePan = true;
  controls.maxPolarAngle = 3*Math.PI/4;
  controls.minPolarAngle = Math.PI/4;
  controls.minDistance = 10;
  controls.maxDistance = far;
    
  //cena e fundo 
  //const bgcolor = new THREE.Color(0xEDEDED);
  const bgcolor = new THREE.Color(0x000000);
  const scene = new THREE.Scene();
  scene.background = bgcolor;

  //luz ambiente

  const light = new THREE.AmbientLight( 0xffffff, 1 ); // soft white light
  scene.add( light );

  

    
  //luz vermelha
  {
    var color = 0xFF0000;
    var intensity = 4;
    var lightR = new THREE.DirectionalLight(color, intensity);
    lightR.position.set(5, 10, 10);
    scene.add(lightR);
    scene.add(lightR.target);
  }

   
    //luz azul
  {
    var color = 0x0000FF;
    var intensity = 5; 
    var lightB = new THREE.DirectionalLight(color, intensity);
    lightB.position.set(2, -5, 2);
    scene.add(lightB);
    scene.add(lightB.target);
  }

   
    //luz verde
    
  {
    var color = 0x00FF00;
    var intensity = 3;
    var lightG = new THREE.DirectionalLight(color, intensity);
    lightG.position.set(-10, 12, 2);
    scene.add(lightG);
    scene.add(lightG.target);
  }
  
 

//lupa

//var lupa;

//{
//  var objLoader = new OBJLoader(manager);
//  var mat = new THREE.MeshPhysicalMaterial({
//    color: 0xffffff,
//    side: THREE.DoubleSide,
//    transparent: true,
//     opacity: 1,
//     transmission: 1,
//     reflectivity: 1,
//     roughness: 0,
//     metalness: 0.0,
//     ior: 1.2,
//     thickness: 5
//   });

  objLoader.load('LUPA.obj', function (obj) {
    obj.traverse(function (child) {
      if (child instanceof THREE.Mesh) {
        child.material = mat;
      }
    });

    lupa = obj;
    scene.add(lupa);
    lupa.rotation.y = Math.PI;
  });
}

// Posição e rotação RANDOM

function randomizePositionAndRotation(busto) {
  const targetPosition = new THREE.Vector3(
    (Math.random() - 0.5) * 4,
    (Math.random() - 0.5) * 8,
    (Math.random() - 0.5) * 4
  );

  const targetRotation = new THREE.Quaternion();
  targetRotation.setFromEuler(
    new THREE.Euler(
      Math.random() * Math.PI * 2,
      Math.random() * Math.PI * 2,
      Math.random() * Math.PI * 2,
      'XYZ'
    )
  );

  // Use Tween.js for smooth position transition
  new TWEEN.Tween(busto.position)
    .to(targetPosition, 3000) // Transition duration: 1000ms (adjust as needed)
    .easing(TWEEN.Easing.Quadratic.Out) // Easing function for smooth transition
    .start();

  // Use Tween.js for smooth rotation transition
  new TWEEN.Tween(busto.rotation)
    .to({ x: targetRotation.x, y: targetRotation.y, z: targetRotation.z, w: targetRotation.w }, 3000) // Transition duration: 1000ms (adjust as needed)
    .easing(TWEEN.Easing.Quadratic.Out) // Easing function for smooth transition
    .start();
}


    //bustos

    const loader = new GLTFLoader();
  

    var busto83;

             loader.load('./BUSTO_83.glb', function (glb) {
  //busto83 = glb.scene;
  busto83 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto83.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided

    }
  });

  scene.add(busto83);

});


var busto84;

             loader.load('./BUSTO_84.glb', function (glb) {
  busto84 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto84.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });

  scene.add(busto84);
  
});

var busto85;

             loader.load('./BUSTO_85.glb', function (glb) {
  busto85 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto85.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });

  scene.add(busto85);
});

var busto86;

             loader.load('./BUSTO_86.glb', function (glb) {
  busto86 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto86.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });

  scene.add(busto86);
});

var busto87;

loader.load('./BUSTO_87.glb', function (glb) {
  busto87 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto87.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });

  randomizePositionAndRotation(busto87);
  scene.add(busto87);
});

var busto88;

loader.load('./BUSTO_88.glb', function (glb) {
  busto88 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto88.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });


  scene.add(busto88);
});

var busto93;

loader.load('./BUSTO_93.glb', function (glb) {
  busto93 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto93.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });

  scene.add(busto93);
});

var busto94;

loader.load('./BUSTO_94.glb', function (glb) {
  busto94 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto94.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });

  scene.add(busto94);
});

var busto95;

loader.load('./BUSTO_95.glb', function (glb) {
  busto95 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto95.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });

  scene.add(busto95);
});

var busto96;

loader.load('./BUSTO_96.glb', function (glb) {
  busto96 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto96.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });

  scene.add(busto96);
});

var busto97;

loader.load('./BUSTO_97.glb', function (glb) {
  busto97 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto97.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });


  scene.add(busto97);
});

var busto99;

loader.load('./BUSTO_99.glb', function (glb) {
  busto99 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto99.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });


  scene.add(busto99);
});

var busto100;

loader.load('./BUSTO_100.glb', function (glb) {
  busto100 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto100.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });


  scene.add(busto100);
});

var busto101;

loader.load('./BUSTO_101.glb', function (glb) {
  busto101 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto101.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });


  scene.add(busto101);
});

var busto102;

loader.load('./BUSTO_102.glb', function (glb) {
  busto102 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto102.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });


  scene.add(busto102);
});

var busto107;

loader.load('./BUSTO_107.glb', function (glb) {
  busto107 = glb.scene;

  // Traverse through all the meshes in the model and set their material's side property
  busto107.traverse(function (child) {
    if (child.isMesh) {
      child.material.side = THREE.DoubleSide; // Set material to double-sided
    }
  });

  
  scene.add(busto107);
});



  //Rotatividade dos modelos

  var rotatividade = function (event) {
  randomizePositionAndRotation(busto84);
  randomizePositionAndRotation(busto85);
  randomizePositionAndRotation(busto86);
  randomizePositionAndRotation(busto87);
  randomizePositionAndRotation(busto88);
  randomizePositionAndRotation(busto93);
  randomizePositionAndRotation(busto94);
  randomizePositionAndRotation(busto95);
  randomizePositionAndRotation(busto96);
  randomizePositionAndRotation(busto97);
  randomizePositionAndRotation(busto99);
  randomizePositionAndRotation(busto100);
  randomizePositionAndRotation(busto101);
  randomizePositionAndRotation(busto102);
  randomizePositionAndRotation(busto107);
  randomizePositionAndRotation(busto83);

  randomizePositionAndRotation(lightR);
randomizePositionAndRotation(lightB);
randomizePositionAndRotation(lightG);
};




// formas de interacao
/* 
document.querySelector('#c').addEventListener('dblclick', rotatividade, false);
document.querySelector('#c').addEventListener("touchstart", tapHandler);

var tapedTwice = false;

function tapHandler(event) {
    if(!tapedTwice) {
        tapedTwice = true;
        setTimeout( function() { tapedTwice = false; }, 300 );
        return false;
    }
    event.preventDefault();
    rotatividade();
 }
 */


 const previousButton = document.getElementById('previousButton');
  const nextButton = document.getElementById('nextButton');
  const okButton = document.getElementById('okButton');

  previousButton.addEventListener('click', () => {
    // Handle previous button click event
    rotatividade()
  });

  nextButton.addEventListener('click', () => {
    // Handle next button click event
    rotatividade()
  });

  okButton.addEventListener('click', () => {
    // Handle close button click event
    rotatividade()
  });

//redimensionamento da janela

  function resizeRendererToDisplaySize(renderer) {
    var canvas = renderer.domElement;
    var width = canvas.clientWidth;
    var height = canvas.clientHeight;
    var needResize = canvas.width !== width || canvas.height !== height;
    if (needResize) {
      renderer.setSize(width, height, false);
    }
    return needResize;
  }

  const clock = new THREE.Clock()



  //funcao de animacao
 function animate() {

  const elapsedTime = clock.getElapsedTime()%22

  if (elapsedTime >= 10 && elapsedTime <= 11) {
    
//   if(lupa) lupa.rotation.y -= Math.random()*0.05;
	  rotatividade()

} else if (elapsedTime >= 15 && elapsedTime <= 16) {

 // if(lupa) lupa.rotation.y += Math.random()*0.1;
	  rotatividade()

} else if (elapsedTime >= 17 && elapsedTime <= 18) {

//if(lupa) lupa.rotation.y -= Math.random()*0.1;
	  rotatividade()

} else if (elapsedTime >= 19 && elapsedTime <= 20) {

//if(lupa) lupa.rotation.y -= Math.random()*0.1;
	  rotatividade()

} else if (elapsedTime >= 21) {

//if(lupa) lupa.rotation.y += Math.random()*0.1;
	  rotatividade()

}

   if(busto83) busto83.rotation.y -= 0.002;    
   if(busto84) busto84.rotation.y -= 0.002;   
   if(busto85) busto85.rotation.y += 0.002;   
   if(busto86) busto86.rotation.y -= 0.002;  
   if(busto87) busto87.rotation.y -= 0.002;
   if(busto88) busto88.rotation.y += 0.002;
   if(busto93) busto93.rotation.y -= 0.002;
   if(busto94) busto94.rotation.y -= 0.002;
   if(busto95) busto95.rotation.y += 0.002;
   if(busto96) busto96.rotation.y += 0.002;
   if(busto97) busto97.rotation.y -= 0.002;
   if(busto99) busto99.rotation.y += 0.002;
   if(busto100) busto100.rotation.y -= 0.002;
   if(busto101) busto101.rotation.y += 0.002;
   if(busto102) busto102.rotation.y -= 0.002;
   if(busto107) busto107.rotation.y += 0.002;

 
    renderer.render(scene, camera);

    if (resizeRendererToDisplaySize(renderer)) {
      var canvas = renderer.domElement;
      camera.aspect = canvas.clientWidth / canvas.clientHeight;
      camera.updateProjectionMatrix();
    }
    controls.update();

    TWEEN.update();
    
    //console.log(state);

    requestAnimationFrame(animate);
    
};

animate();




    </script>
</head>

<body>
<!-- Botões prev e next -->
<div class="button-prev">
  <button id="previousButton">
    <img src="prev.svg" alt="Previous">
  </button>
</div>

<div class="button-next">
  <button id="nextButton">
    <img src="next.svg" alt="Next">
  </button>
</div>

  <!-- Info inicial -->
  <div class="info">
    <div class="message"><h3>Inscription</h3><br><br><img src="orbit.svg"/>&nbsp&nbsp&nbsp<img src="zoom.svg"/><br>Interaja arrastando e ampliando.<br><br><img src="language.svg"/><br>Click on EN / PT button to change language.<br><br></div>
    <br />
    <button class="ok" id="okButton" onclick="this.parentElement.style.display='none';">OK</button>
</div>

<div class="sobre" id="sobreMsg">
  <div class="message">
    <h3>Inscription</h3>
    <a href="https://carlostrancoso.com/"><h2>Carlos Trancoso</h2></a>

    <i>Inscription</i> é o resultado da residência artística realizada no <a href="https://goo.gl/maps/h83XrYbAej5rGabY7">Fórum Maia</a> durante a <a href="https://bienaldamaia23.pt/">Bienal da Maia 2023</a>.<br>Ao longo de um período de duas semanas, pessoas envolvidas ativamente na concepção e produção da Bienal de Arte Contemporânea foram fotografadas e transformadas em modelos 3D, sendo expostas como esculturas em papel. Durante os cinco meses da Bienal, estas pessoas tornam-se residentes permanentes ou ocasionais do Fórum Maia, participando numa performance espontânea com a exposição. Os visitantes têm a oportunidade de testemunhar e interagir com estas pessoas, ampliando a percepção das esculturas e estabelecendo conexões entre pessoas reais (por meio da percepção geral), representações de avatares (por meio deste site) e as versões objetificadas (por meio das esculturas). Ao participar neste projeto, os indivíduos assumem uma <i>Inscrição</i> como expressão metafórica do consentimento diário exigido pela web, ingressando num <i>clube</i> associado ao espaço e tempo da Bienal.<br>Esta exposição integra o projeto <a href="https://carlostrancoso.com/rise-of-trivial/"><i>Rise of trivial</i></a>.<br>
    <br/>
    <button class="close" onclick="document.getElementById('sobreMsg').style.visibility = 'hidden'">Fechar</button>    
  </div>
</div>





<!-- Top navigation -->
<div class="topnav">

  <!-- Centered link -->
 <!--  <div class="topnav-centered" onclick="document.getElementById('sobreMsg').style.visibility = 'visible'">
    <a>About</a>
  </div> -->

  <!-- Left-aligned links (default) -->
  <div class="topnav-left" onclick="document.getElementById('sobreMsg').style.visibility = 'visible'">
    <a>Sobre</a>
  </div>

  <!-- Right-aligned links -->
  <div class="topnav-right">
    <a href="https://carlostrancoso.github.io/InscriptionEN/">EN / PT <img src="language.svg"/> </a>
  </div>

</div>

  <canvas id="c"></canvas>
  <div class="loading-screen">
    <label for="loading-screen">A carregar...</label>
  </div>
</body>

</html>
